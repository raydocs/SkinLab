# fn-12-z04.2 分析服务集成(Firebase/Mixpanel)

## Description
集成分析服务，替换现有的TODO桩实现。

**当前状态**: `AnalyticsEvents.swift` 只有TODO注释：
```swift
static func logEvent(name: String, parameters: [String: Any]? = nil) {
    // TODO: Integrate with analytics provider
    #if DEBUG
    print("[Analytics] \(name): \(parameters ?? [:])")
    #endif
}
```

**目标**:
1. 选择并集成分析服务 (Firebase Analytics 推荐)
2. 保持现有API不变
3. 支持DEBUG模式日志
4. 遵循ATT隐私规范

## Key Files
- `/SkinLab/Services/AnalyticsEvents.swift` - 分析服务入口
- `/SkinLab/SkinLabApp.swift` - 初始化位置
- `Package.swift` 或 Xcode项目 - 添加依赖

## Implementation Notes
```swift
import FirebaseAnalytics

struct AnalyticsService {
    static func configure() {
        FirebaseApp.configure()
    }

    static func logEvent(name: String, parameters: [String: Any]? = nil) {
        #if DEBUG
        print("[Analytics] \(name): \(parameters ?? [:])")
        #endif

        Analytics.logEvent(name, parameters: parameters)
    }

    static func setUserProperty(_ value: String?, forName name: String) {
        Analytics.setUserProperty(value, forName: name)
    }
}

// App初始化
@main
struct SkinLabApp: App {
    init() {
        AnalyticsService.configure()
    }
}
```

## Acceptance
- [ ] Firebase Analytics SDK集成
- [ ] 初始化代码添加
- [ ] logEvent方法实际上报
- [ ] DEBUG模式保留控制台日志
- [ ] ATT权限请求（如需）
- [ ] 单元测试验证调用

## Quick Commands
```bash
xcodebuild build -scheme SkinLab -destination 'platform=iOS Simulator,name=iPhone 17'
```

## Done summary
Integrated Firebase Analytics service abstraction with thread-safe singleton, provider protocol for testability, and DEBUG console logging. Added 16 unit tests.
## Evidence
- Commits: 63d21e0d53d20b129df2c132831c6223d6206398
- Tests: xcodebuild test -scheme SkinLab -only-testing:SkinLabTests/AnalyticsServiceTests
- PRs: